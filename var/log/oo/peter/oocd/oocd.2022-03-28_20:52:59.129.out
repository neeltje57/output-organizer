Don't change anything in this section or the file might be deleted during housekeeping.
Script result code: 000
Expiration date   : 2022-03-31
Execution started : 2022-03-28_20:52:59.129
script            : oocd
User              : peter
Execution ended   : 2022-03-28_20:52:59.147
stdout            : /home/peter/oo/var/log/oo/peter/oocd/oocd.2022-03-28_20:52:59.129.out
temp_stdout       : /tmp/tmp.bLemOLJDXC
temp_stderr       : /tmp/tmp.YpdTrulJ5t
Expiration days   : 3
Expiration (min)  : 3
Expiration (max)  : 100
timeout (in sec)  : 60
variable 1        : 
variable 2        : 
variable 3        : 
variable 4        : 
variable 5        : 
variable 6        : 
variable 7        : 
variable 8        : 

========== stderr below ==========
stderr is empty
========== stderr above ==========

========== stdout below ==========
stdout is empty
========== stdout above ==========
========== script below ==========
#!/bin/bash
# ==================================================================================
# /usr/local/bin/oocdnew
# ==================================================================================
# Change this variable to the directory where the configuration files are stored.  =
# Normally this would be: oo_confpath="/etc/oos"                                   =
# The quotes are needed in case there are spaces in the directory name.            =
oo_confpath="/home/peter/oo/etc/oo"
# ==================================================================================

# ===========================================================================
# Don't change anything below this line unless you know what you are doing. =
# ===========================================================================

# Load configuration file
# Get parms from system config file
if [[ -f "$oo_confpath"/oo.conf ]] ; then
  eval $(grep "^oo_logbasepath=" "$oo_confpath"/oo.conf)
fi
if [[ -z "$oo_logbasepath" \
   ]]; then
  echo "One or more mandatory variables are not set in the config file: ""$oo_confpath"/oo.conf
  echo "  oo_logbasepath          : ""$oo_logbasepath"
  echo "see documentation"
  exit 1
fi

oo_temp_logfile=$(mktemp)
oo_deleted_dirs=0

{
# loop through the directories
for oocd_directory in $oo_logbasepath/*
do
  if [[ -d $oocd_directory ]]; then
    oocd_userdir=`basename "$oocd_directory"`
    if [[ -z "$(getent passwd $oocd_userdir)" ]]; then
      # delete directory of non existent user
      echo "Deleting "$oocd_directory" ..."
      (( oo_deleted_dirs++ ))
      rm -rf "$oocd_directory"
    fi
  fi
done
} >$oo_temp_logfile

cat $oo_temp_logfile
rm -f $oo_temp_logfile
========== script above ==========

